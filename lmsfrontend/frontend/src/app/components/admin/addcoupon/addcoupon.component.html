<div class="container mx-auto p-4">
    <h2 class="text-2xl font-bold mb-6"> {{ isEditMode ? 'Edit Coupon' : 'Create New Coupon' }}</h2>
  
    <form [formGroup]="couponForm" (ngSubmit)="onSubmit()" class="max-w-2xl">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Coupon Code -->
        <div class="form-group">
          <label for="code" class="block text-sm font-medium mb-1">Coupon Code *</label>
          <input 
            type="text" 
            id="code"
            formControlName="code" 
            placeholder="Enter coupon code"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            [ngClass]="{'border-red-500': isFieldInvalid('code')}"
          >
          <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('code')">
            <span *ngIf="couponForm.get('code')?.errors?.['required']">Coupon code is required</span>
            <span *ngIf="couponForm.get('code')?.errors?.['minlength']">Coupon code must be at least 3 characters</span>
            <span *ngIf="couponForm.get('code')?.errors?.['pattern']">Only letters and numbers are allowed</span>
          </div>
        </div>
  
        <!-- Coupon Type -->
        <div class="form-group">
          <label for="type" class="block text-sm font-medium mb-1">Type *</label>
          <select 
            id="type"
            formControlName="type"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            [ngClass]="{'border-red-500': isFieldInvalid('type')}"
          >
            <option value="">Select Type</option>
            <option value="percentage">Percentage</option>
            <option value="fixed">Fixed Amount</option>
          </select>
          <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('type')">
            <span *ngIf="couponForm.get('type')?.errors?.['required']">Please select a coupon type</span>
          </div>
        </div>
  
        <!-- Value -->
        <div class="form-group">
          <label for="value" class="block text-sm font-medium mb-1">Value *</label>
          <input 
            type="number" 
            id="value"
            formControlName="value" 
            placeholder="Enter value"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            [ngClass]="{'border-red-500': isFieldInvalid('value')}"
          >
          <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('value')">
            <span *ngIf="couponForm.get('value')?.errors?.['required']">Value is required</span>
            <span *ngIf="couponForm.get('value')?.errors?.['min']">Value must be greater than 0</span>
            <span *ngIf="couponForm.get('value')?.errors?.['max']">Value cannot exceed 100 for percentage type</span>
          </div>
        </div>
  
        <!-- Max Uses -->
        <div class="form-group">
          <label for="maxUses" class="block text-sm font-medium mb-1">Maximum Uses *</label>
          <input 
            type="number" 
            id="maxUses"
            formControlName="maxUses" 
            placeholder="Enter maximum uses"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            [ngClass]="{'border-red-500': isFieldInvalid('maxUses')}"
          >
          <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('maxUses')">
            <span *ngIf="couponForm.get('maxUses')?.errors?.['required']">Maximum uses is required</span>
            <span *ngIf="couponForm.get('maxUses')?.errors?.['min']">Maximum uses must be at least 1</span>
          </div>
        </div>
  
        <!-- Expiry Date -->
        <div class="form-group">
          <label for="expiryDate" class="block text-sm font-medium mb-1">Expiry Date *</label>
          <input 
            type="date" 
            id="expiryDate"
            formControlName="expiryDate"
            [min]="minDate"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            [ngClass]="{'border-red-500': isFieldInvalid('expiryDate')}"
          >
          <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('expiryDate')">
            <span *ngIf="couponForm.get('expiryDate')?.errors?.['required']">Expiry date is required</span>
            <span *ngIf="couponForm.get('expiryDate')?.errors?.['pastDate']">Expiry date must be in the future</span>
          </div>
        </div>
  
        <!-- Min Purchase Amount -->
        <div class="form-group">
          <label for="minPurchaseAmount" class="block text-sm font-medium mb-1">Minimum Purchase Amount *</label>
          <input 
            type="number" 
            id="minPurchaseAmount"
            formControlName="minPurchaseAmount"
            placeholder="Enter minimum purchase amount"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            [ngClass]="{'border-red-500': isFieldInvalid('minPurchaseAmount') || couponForm.errors?.['minPurchaseAmountInvalid']}"
          >
          <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('minPurchaseAmount') || couponForm.errors?.['minPurchaseAmountInvalid']">
            <span *ngIf="couponForm.get('minPurchaseAmount')?.errors?.['required']">Minimum purchase amount is required</span>
            <span *ngIf="couponForm.get('minPurchaseAmount')?.errors?.['min']">Amount must be greater than 0</span>
            <span *ngIf="couponForm.errors?.['minPurchaseAmountInvalid']">Minimum purchase amount must be greater than maximum discount amount</span>
          </div>
        </div>
  
        <!-- Max Discount Amount -->
        <div class="form-group">
          <label for="maxDiscountAmount" class="block text-sm font-medium mb-1">Maximum Discount Amount</label>
          <input 
            type="number" 
            id="maxDiscountAmount"
            formControlName="maxDiscountAmount"
            placeholder="Enter maximum discount amount"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            [ngClass]="{'border-red-500': isFieldInvalid('maxDiscountAmount')}"
          >
          <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('maxDiscountAmount')">
            <span *ngIf="couponForm.get('maxDiscountAmount')?.errors?.['min']">Amount must be greater than 0</span>
          </div>
        </div>
  
        <!-- Description -->
        <div class="form-group md:col-span-2">
          <label for="description" class="block text-sm font-medium mb-1">Description</label>
          <textarea 
            id="description"
            formControlName="description" 
            rows="3"
            placeholder="Enter coupon description"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
            [ngClass]="{'border-red-500': isFieldInvalid('description')}"
          ></textarea>
          <div class="text-red-500 text-sm mt-1" *ngIf="isFieldInvalid('description')">
            <span *ngIf="couponForm.get('description')?.errors?.['maxlength']">Description cannot exceed 200 characters</span>
          </div>
        </div>
      </div>
  
      <div class="mt-6">
        <button 
          type="submit" 
          [disabled]="!couponForm.valid"
          class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
        >
        {{ isEditMode ? 'Update Coupon' : 'Create Coupon' }}
        </button>
      </div>
    </form>
  </div>
